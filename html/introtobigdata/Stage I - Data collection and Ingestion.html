<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Stage I - Data collection and Ingestion - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{background-color:#eaffea;color:#55a532}.hljs-deletion{background-color:#ffecec;color:#bd2c00}.hljs-link{text-decoration:underline}.markdown-body{word-wrap:break-word;font-size:16px;line-height:1.5}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e7e7e7;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #ddd;color:#777;font-size:16px;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb;color:#555;display:inline-block;font-size:11px;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eee;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#777;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:700;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #ddd;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{background-color:initial;max-width:none;vertical-align:text-top}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#0000000a;border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{content:"\00a0";letter-spacing:-.2em}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:#0000;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{background-color:#f7f7f7;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown-body pre code,.markdown-body pre tt{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{background:#f8f8f8;border-top:0;font-weight:700}.news .alert .markdown-body blockquote{border:0;padding:0 0 0 40px}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{cursor:default!important;float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle}.markdown-body{max-width:758px;overflow:visible!important;padding-bottom:40px;padding-top:40px;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{border-right:3px solid #6ce26c!important;box-sizing:initial;color:#afafaf!important;cursor:default;display:inline-block;min-width:20px;padding:0 8px 0 0;position:relative;text-align:right;z-index:4}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-bottom:none;border-left:none;border-top:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-collapse:inherit!important;border-spacing:0}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{margin-bottom:unset;overflow:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{background-color:inherit;border-radius:0;overflow:visible;text-align:center;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{height:100%;max-width:100%}.markdown-body pre>code.wrap{word-wrap:break-word;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{background-color:#000;background-position:50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;display:table;overflow:hidden;text-align:center}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{object-fit:contain;width:100%;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{height:100%;left:0;position:absolute;top:0;width:100%}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{color:#fff;height:auto;left:50%;opacity:.3;position:absolute;top:50%;transform:translate(-50%,-50%);transition:opacity .2s;width:auto;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.figma{display:table;padding-bottom:56.25%;position:relative;width:100%}.figma iframe{border:1px solid #eee;bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.markmap-container{height:300px}.markmap-container>svg{height:100%;width:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{color:#777;margin:25px auto -25px;max-width:760px;position:relative;z-index:2}.toc .invisable-node{list-style-type:none}.ui-toc{bottom:20px;position:fixed;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{border-bottom-left-radius:0;border-top-left-radius:0;height:40px;padding:10px 4px}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{color:#fff;opacity:1;transition:opacity .2s}.ui-toc-label:focus{background-color:#ccc;color:#000;opacity:.3}.ui-toc-label:hover{background-color:#ccc;opacity:1;transition:opacity .2s}.ui-toc-dropdown{margin-bottom:20px;margin-top:20px;max-height:70vh;max-width:45vw;overflow:auto;padding-left:10px;padding-right:10px;text-align:inherit;width:25vw}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{letter-spacing:.0029em;padding-right:0}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{color:#767676;display:block;font-size:13px;font-weight:500;padding:4px 20px}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{background-color:initial;border-left:1px solid #000;color:#000;padding-left:19px;text-decoration:none}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{border-left:none;border-right:1px solid #000;padding-right:19px}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{background-color:initial;border-left:2px solid #000;color:#000;font-weight:700;padding-left:18px}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{border-left:none;border-right:2px solid #000;padding-right:18px}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:30px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:40px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{font-weight:500;padding-left:28px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{font-weight:500;padding-left:38px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{max-height:70vh;max-width:15vw;overflow:auto;position:fixed;top:0}.back-to-top,.expand-toggle,.go-to-bottom{color:#999;display:block;font-size:12px;font-weight:500;margin-left:10px;margin-top:10px;padding:4px 10px}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:50%;display:block;height:20px;margin-bottom:2px;margin-right:5px;margin-top:2px;width:20px}.ui-user-icon.small{display:inline-block;height:18px;margin:0 0 .2em;vertical-align:middle;width:18px}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;padding-left:22px;text-decoration:none}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}.inline-spoiler-section{cursor:pointer}.inline-spoiler-section .spoiler-text{background-color:#333;border-radius:2px}.inline-spoiler-section .spoiler-text>*{opacity:0}.inline-spoiler-section .spoiler-img{filter:blur(10px)}.inline-spoiler-section.raw{background-color:#333;border-radius:2px}.inline-spoiler-section.raw>*{opacity:0}.inline-spoiler-section.unveil{cursor:auto}.inline-spoiler-section.unveil .spoiler-text{background-color:#3333331a}.inline-spoiler-section.unveil .spoiler-text>*{opacity:1}.inline-spoiler-section.unveil .spoiler-img{filter:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{color:#222;position:relative;z-index:1}.markdown-body.slides:before{background-color:currentColor;bottom:0;box-shadow:0 0 0 50vw;content:"";display:block;left:0;position:absolute;right:0;top:0;z-index:-1}.markdown-body.slides section[data-markdown]{background-color:#fff;margin-bottom:1.5em;position:relative;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{left:1em;max-height:100%;overflow:hidden;position:absolute;right:1em;top:50%;transform:translateY(-50%)}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{border:3px solid #777;content:"";height:1.5em;position:absolute;right:1em;top:-1.5em}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}svg{text-shadow:none}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="Stage-I---Data-collection-and-Ingestion" data-id="Stage-I---Data-collection-and-Ingestion"><a class="anchor hidden-xs" href="#Stage-I---Data-collection-and-Ingestion" title="Stage-I---Data-collection-and-Ingestion"><span class="octicon octicon-link"></span></a><span>Stage I - Data collection and Ingestion</span></h1><p><strong><span>Course:</span></strong><span> Big Data - IU S23</span><br>
<strong><span>Author:</span></strong><span> Firas Jolha</span></p><h1 id="Dataset" data-id="Dataset"><a class="anchor hidden-xs" href="#Dataset" title="Dataset"><span class="octicon octicon-link"></span></a><span>Dataset</span></h1><ul>
<li><a href="http://www.cems.uwe.ac.uk/~pchatter/resources/html/emp_dept_data+schema.html" target="_blank" rel="noopener"><span>Some emps and depts</span></a></li>
</ul><h1 id="Agenda" data-id="Agenda"><a class="anchor hidden-xs" href="#Agenda" title="Agenda"><span class="octicon octicon-link"></span></a><span>Agenda</span></h1><p><span class="toc"><ul>
<li><a href="#Stage-I---Data-collection-and-Ingestion" title="Stage I - Data collection and Ingestion">Stage I - Data collection and Ingestion</a></li>
<li><a href="#Dataset" title="Dataset">Dataset</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Description" title="Description">Description</a></li>
<li><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li><a href="#Build-a-relational-Database-via-PostgreSQL" title="Build a relational Database via PostgreSQL">Build a relational Database via PostgreSQL</a></li>
<li><a href="#AVRO-amp-Snappy" title="AVRO &amp; Snappy">AVRO &amp; Snappy</a></li>
<li><a href="#Import-the-database-into-HDFS-via-Sqoop" title="Import the database into HDFS via Sqoop">Import the database into HDFS via Sqoop</a><ul>
<li><a href="#Sqoop-eval" title="Sqoop eval">Sqoop eval</a></li>
<li><a href="#Sqoop-import" title="Sqoop import">Sqoop import</a></li>
<li><a href="#Sqoop-job" title="Sqoop job">Sqoop job</a></li>
<li><a href="#self-study-Incremental-import" title="[self-study] Incremental import">[self-study] Incremental import</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</span></p><h1 id="Prerequisites" data-id="Prerequisites"><a class="anchor hidden-xs" href="#Prerequisites" title="Prerequisites"><span class="octicon octicon-link"></span></a><span>Prerequisites</span></h1><ul>
<li><span>HDP 2.6.5 is installed</span></li>
</ul><h1 id="Objectives" data-id="Objectives"><a class="anchor hidden-xs" href="#Objectives" title="Objectives"><span class="octicon octicon-link"></span></a><span>Objectives</span></h1><ul>
<li><span>Build a relational database in PostgreSQL</span></li>
<li><span>Import the database into HDFS via Sqoop</span></li>
</ul><h1 id="Description" data-id="Description"><a class="anchor hidden-xs" href="#Description" title="Description"><span class="octicon octicon-link"></span></a><span>Description</span></h1><p><span>Big data is changing the way companies do business and creating a need for data engineers who can collect and manage large quantities of data. Data engineering is the practice of designing and building systems for collecting, storing, and analyzing data at scale.</span></p><center>
<img src="https://i.imgur.com/oIxLrv7.png" width="600">
<p>This is just a typical big data pipeline</p>
</center><p><span>In the final project of this course, you need to build an end-to-end big data pipeline which accepts input data files, analyzes the data in the cluster and displays the results in a web dashboard. We divided the pipeline into four stages where in this tutorial we will cover the first stage. Before starting to build the pipeline, it is always good to check the data and perform preprocessing if needed. For simplicity, here, we are dealing with batch data since the data in the files is fixed and no real-time update exists. In this first stage, we have to do as follows:</span><br>
<span>1- Build a relational database via PostgreSQL</span><br>
<span>2- Import the database into HDFS via Sqoop</span></p><h1 id="Dataset-Description" data-id="Dataset-Description"><a class="anchor hidden-xs" href="#Dataset-Description" title="Dataset-Description"><span class="octicon octicon-link"></span></a><span>Dataset Description</span></h1><p><span>The dataset is about the departments and employees in a company. It consists of 2 </span><code>.csv</code><span> files.</span></p><p><span>The file </span><code>emps.csv</code><span> contains information about employees:</span></p><ul>
<li><span>EMPNO is a unique employee number; it is the primary key of the employee table.</span></li>
<li><span>ENAME stores the employee’s name.</span></li>
<li><span>The JOB attribute stores the name of the job the employee does.</span></li>
<li><span>The MGR attribute contains the employee number of the employee who manages that employee. If the employee has no manager, then the MGR column for that employee is left set to null.</span></li>
<li><span>The HIREDATE column stores the date on which the employee joined the company.</span></li>
<li><span>The SAL column contains the details of employee salaries.</span></li>
<li><span>The COMM attribute stores values of commission paid to employees. Not all employees receive commission, in which case the COMM field is set to null.</span></li>
<li><span>The DEPTNO column stores the department number of the department in which each employee is based. This data item acts a foreign key, linking the employee details stored in the EMP table with the details of departments in which employees work, which are stored in the DEPT table.</span></li>
</ul><p><span>The file </span><code>depts.csv</code><span> contains information about departments:</span></p><ul>
<li><span>DEPTNO: The primary key containing the department numbers used to identify each department.</span></li>
<li><span>DNAME: The name of each department.</span></li>
<li><span>LOC: The location where each department is based.</span></li>
</ul><div class="alert alert-info">
<p><span>I created these </span><code>csv</code><span> files from the tables provided in the link.</span></p>
</div><h1 id="Build-a-relational-Database-via-PostgreSQL" data-id="Build-a-relational-Database-via-PostgreSQL"><a class="anchor hidden-xs" href="#Build-a-relational-Database-via-PostgreSQL" title="Build-a-relational-Database-via-PostgreSQL"><span class="octicon octicon-link"></span></a><span>Build a relational Database via PostgreSQL</span></h1><p><span>In this step, you need to write SQL statements for creating the database (let’s call it  </span><code>project</code><span>) and importing the </span><code>csv</code><span> files into it. You can test the statements in an interactive mode but for project purposes, you need to write them in </span><code>.sql</code><span> file and then you execute the statements by passing the file via command </span><code>psql</code><span> which should replicate all the steps.</span></p><p><span>I will give here some of the basic steps to create the database </span><code>project</code><span> but feel free to extend it for your project purposes.</span></p><ol>
<li><span>Drop the databases if exist.</span></li>
</ol><pre><code class="wrap sh hljs">psql <span class="hljs-operator">-</span>U postgres <span class="hljs-operator">-</span>c <span class="hljs-string">'DROP DATABASE IF EXISTS project;'</span>
</code></pre><ol start="2">
<li><span>Create a database </span><code>project</code></li>
</ol><pre><code class="wrap sh hljs">psql <span class="hljs-operator">-</span>U postgres <span class="hljs-operator">-</span>c <span class="hljs-string">'CREATE DATABASE project;'</span>
</code></pre><div class="alert alert-info">
<p><span>You can merge the previous commands into one call of </span><code>psql</code><span> command.</span></p>
</div><p><span>We will store the SQL statements in a file </span><code>db.sql</code><span>.</span><br>
<span>3. Create tables </span><code>emps</code><span>, </span><code>depts</code><span>, </span><code>salgrades</code></p><pre><code class="wrap sql hljs"><span class="hljs-comment">-- switch to the database</span>
\c project;

<span class="hljs-comment">-- Optional</span>
<span class="hljs-keyword">START</span> TRANSACTION;

<span class="hljs-comment">-- Add tables</span>
<span class="hljs-comment">-- emps table</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> emps (
    empno <span class="hljs-type">integer</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    ename <span class="hljs-type">VARCHAR</span> ( <span class="hljs-number">50</span> ) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    job <span class="hljs-type">VARCHAR</span> ( <span class="hljs-number">50</span> ) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    mgr <span class="hljs-type">integer</span>,
    hiredate <span class="hljs-type">date</span>,
    sal <span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>),
    comm <span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>),
    deptno <span class="hljs-type">integer</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
);

<span class="hljs-comment">-- dept table</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> depts(
    deptno <span class="hljs-type">integer</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    dname <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    location <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
);
</code></pre><div class="alert alert-info">
<p><strong><span>Note:</span></strong><span> In the standard, it is not necessary to issue START TRANSACTION to start a transaction block: any SQL command implicitly begins a block. PostgreSQL’s behavior can be seen as implicitly issuing a COMMIT after each command that does not follow START TRANSACTION (or BEGIN), and it is therefore often called “autocommit”. Other relational database systems might offer an </span><em><span>autocommit</span></em><span> feature as a convenience.</span></p>
</div><ol start="4">
<li><span>Add the constraints.</span></li>
</ol><pre><code class="wrap sql hljs"><span class="hljs-comment">-- Add constraints</span>
<span class="hljs-comment">-- FKs</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> emps <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> fk_emps_mgr_empno <span class="hljs-keyword">FOREIGN</span> KEY(mgr) <span class="hljs-keyword">REFERENCES</span> emps (empno);

<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> emps <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> fk_emps_deptno_deptno <span class="hljs-keyword">FOREIGN</span> KEY(deptno) <span class="hljs-keyword">REFERENCES</span> depts (deptno);
</code></pre><ol start="5">
<li><span>Load data from </span><code>csv</code><span> files.</span></li>
</ol><pre><code class="wrap sql hljs">
<span class="hljs-keyword">SET</span> datestyle <span class="hljs-keyword">TO</span> iso, ymd;

\<span class="hljs-keyword">COPY</span> emps <span class="hljs-keyword">FROM</span> <span class="hljs-string">'data/emps.csv'</span> DELIMITER <span class="hljs-string">','</span> CSV HEADER <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">'null'</span>;

\<span class="hljs-keyword">COPY</span> depts <span class="hljs-keyword">FROM</span> <span class="hljs-string">'data/depts.csv'</span> DELIMITER <span class="hljs-string">','</span> CSV HEADER <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">'null'</span>;
</code></pre><ol start="4">
<li><span>Perform any additional CRUD operation needed on the database. At the end commit the transaction block.</span></li>
</ol><pre><code class="wrap sql hljs"><span class="hljs-comment">-- optional</span>
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- For checking the content of tables</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emps;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> depts;

</code></pre><p><span>You can run the file </span><code>db.sql</code><span> via the command </span><code>psql</code><span> as follows:</span></p><pre><code class="wrap sh hljs">psql <span class="hljs-operator">-</span>U postgres <span class="hljs-operator">-</span>d project <span class="hljs-operator">-</span>f sql<span class="hljs-operator">/</span>db.sql
</code></pre><div class="alert alert-warning">
<p><strong><span>Note:</span></strong><span> Do not forget, that the file </span><code>.sql</code><span> should not return errors when you run it for the second time, so you should clear/drop the objects before creating new database objects.</span></p>
<!-- This is true for all scripts in the pipeline. -->
</div><h1 id="AVRO-amp-Snappy" data-id="AVRO-amp-Snappy"><a class="anchor hidden-xs" href="#AVRO-amp-Snappy" title="AVRO-amp-Snappy"><span class="octicon octicon-link"></span></a><span>AVRO &amp; Snappy</span></h1><p><strong><span>Avro</span></strong><span> is a row oriented semi-structured data format for storing Big Data files, actively used in the Apache Hadoop ecosystem and widely used as a serialization platform. In addition to the semi-structured nature of the Avro format, the files are also splittable, which means that the Hadoop platform can separate the file into individual sections which increases the processing efficiency during data analysis.</span></p><p><img src="https://i.imgur.com/ULVabNI.png" alt="" loading="lazy"></p><p><span>Avro stores the data definition as schemas in JSON format </span><code>.avsc</code><span>, making it easy to read and interpret; the data itself is stored in binary format </span><code>.avro</code><span> making it compact and efficient. Avro files include markers that can be used to split large data sets into subsets suitable for Apache MapReduce processing. When Avro data is read, the schema used when writing it is always present. This also facilitates use with dynamic, scripting languages, since data, together with its schema, is fully self-describing.</span></p><p><img src="https://i.imgur.com/FfwlawE.png" alt="" loading="lazy"></p><p><strong><span>Snappy</span></strong><span> is a compression/decompression library. It optimizes for very high-speed compression and decompression. It does not aim for maximum compression, or compatibility with any other compression library; instead, it aims for very high speeds and reasonable compression.</span></p><p><img src="https://i.imgur.com/nV98eJ7.png" alt="" loading="lazy"></p><p><span>As shown in the chart above that Avro increases storage space and write time modestly while significantly reducing read time. The addition of Snappy compression increases write time minimally, while significantly decreasing storage space and maintaining minimal read time. The resulting combination optimizes for single archival write with multiple read usage.</span></p><h1 id="Import-the-database-into-HDFS-via-Sqoop" data-id="Import-the-database-into-HDFS-via-Sqoop"><a class="anchor hidden-xs" href="#Import-the-database-into-HDFS-via-Sqoop" title="Import-the-database-into-HDFS-via-Sqoop"><span class="octicon octicon-link"></span></a><span>Import the database into HDFS via Sqoop</span></h1><p><span>Sqoop is a command-line tool used for importing data from relational databases to HDFS. It is a data ingestion tool that enables you to bulk import and export data from a database. You can use Sqoop to import data into HDFS or directly into Hive. Sqoop is installed in HDP as a client and we will use the command </span><code>sqoop</code><span> for that purpose. We will import the tables created in PostgreSQL to HDFS and store them in </span><code>/project</code><span> folder.</span></p><p><span>First of all, we need to add some configuration for PostgreSQL as follows:</span><br>
<code>host all all 0.0.0.0/0 trust</code></p><p><span>You need to add it to the file </span><code>/var/lib/pgsql/data/pg_hba.conf</code><span>.</span></p><div class="alert alert-warning">
<p><strong><span>Note:</span></strong><span> Do not forget to restart Postgresql service as </span><code>systemctl restart postgresql</code><span> after updating the config file.</span></p>
</div><p><span>Then we need to download the JDBC driver for Postgresql database and put it in the lib path of Sqoop tool as follows:</span></p><pre><code class="powershell hljs"><div class="wrapper"><div class="gutter linenumber"><span></span>
<span></span>
<span></span></div><div class="code"><span class="hljs-built_in">wget</span> https://jdbc.postgresql.org/download/postgresql<span class="hljs-literal">-42</span>.<span class="hljs-number">6.0</span>.jar <span class="hljs-literal">--no-check-certificate</span>

<span class="hljs-built_in">cp</span>  postgresql<span class="hljs-literal">-42</span>.<span class="hljs-number">6.0</span>.jar /usr/hdp/current/sqoop<span class="hljs-literal">-client</span>/lib/
</div></div></code></pre><p><span>Now we are ready to run commands on Sqoop to call Postgresql databases. You run these commands on the cluster node. Here, I put some examples.</span></p><ol>
<li><span>Sqoop help</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop help
</code></pre><p><img src="https://i.imgur.com/C5tAXPf.png" alt="" loading="lazy"></p><ol start="2">
<li><span>Sqoop version</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop<span class="hljs-literal">-version</span>
</code></pre><p><span>OR</span></p><pre><code class="wrap powershell hljs">sqoop version <span class="hljs-comment"># This is true for all other commands of Sqooop</span>
</code></pre><p><img src="https://i.imgur.com/TFvN81O.png" alt="" loading="lazy"></p><ol start="3">
<li><span>List all databases for user </span><code>postgres</code></li>
</ol><pre><code class="wrap powershell hljs">sqoop list<span class="hljs-literal">-databases</span> <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/postgres <span class="hljs-literal">--username</span> postgres
</code></pre><div class="alert alert-info">
<p><span>The JDBC connection url </span><code>jdbc:postgresql://localhost/postgres</code><span> consists of the schema </span><code>jdbc:postgresql:</code><span>, hostname </span><code>//localhost</code><span> and database name </span><code>postgres</code><span> which is the default database.</span></p>
<p><span>Here </span><code>postgres</code><span> in the url is used only for passing some database. It does not affect the result if we change to some other existing databases.</span></p>
</div><p><img src="https://i.imgur.com/PvgzOr4.png" alt="" loading="lazy"></p><ol start="4">
<li><span>List all tables of database </span><code>project</code><span> for user </span><code>postgres</code></li>
</ol><pre><code class="wrap powershell hljs">sqoop list<span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres
</code></pre><p><img src="https://i.imgur.com/35OqEJA.png" alt="" loading="lazy"></p><h2 id="Sqoop-eval" data-id="Sqoop-eval"><a class="anchor hidden-xs" href="#Sqoop-eval" title="Sqoop-eval"><span class="octicon octicon-link"></span></a><span>Sqoop eval</span></h2><p><span>The </span><code>sqoop eval</code><span> tool allows users to quickly run simple SQL queries against a database; results are printed to the console. This allows users to preview their import queries to ensure they import the data they expect.</span><br>
<span>5. Evaluate a query result of database </span><code>project</code><span> for user </span><code>postgres</code></p><pre><code class="wrap powershell hljs">sqoop eval \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--query</span> <span class="hljs-string">"SELECT * FROM emps WHERE deptno=10"</span> 
</code></pre><div class="alert alert-info">
<p><code>sqoop eval</code><span> accepts only </span><code>--query</code><span> option for evaluating the query. Here, you cannot user </span><code>--where</code><span> option but you can write WHERE predicate in the query.</span></p>
</div><h2 id="Sqoop-import" data-id="Sqoop-import"><a class="anchor hidden-xs" href="#Sqoop-import" title="Sqoop-import"><span class="octicon octicon-link"></span></a><span>Sqoop import</span></h2><p><span>The </span><code>sqoop import</code><span> tool imports an individual table from an RDBMS to HDFS. Each row from a table is represented as a separate record in HDFS. Records can be stored as text files (one record per line), or in binary representation as Avro or SequenceFiles.</span></p><ol start="6">
<li><span>Import a specific table </span><code>emps</code><span> from the database </span><code>project</code><span> with specific columns </span><code>empno, sal, deptno</code><span> and specific predicate </span><code>deptno&gt;10</code><span> and store it in HDFS at default target folder </span><code>/root/emps</code><span>.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop import \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/postgres \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--table</span> emps \
    <span class="hljs-literal">--columns</span> <span class="hljs-string">"empno, sal, deptno"</span> \
    <span class="hljs-literal">--where</span> <span class="hljs-string">"deptno&gt;10"</span>
</code></pre><div class="alert alert-info">
<p><strong><span>Note:</span></strong><span> If you run import for the second time and the file exists in HDFS, it will not </span><strong><span>fail</span></strong><span> the job. You can pass </span><code>--delete-target-dir</code><span> option to remove the old files or specify the new target directory in HDFS via the option </span><code>--target-dir</code><span>.</span></p>
</div><ol start="7">
<li><span>Import the result of a query from the database </span><code>project</code><span> with specific columns </span><code>empno, sal, deptno, dname</code><span> and specific predicate </span><code>deptno&gt;10</code><span> and store it in HDFS at a specific target folder </span><code>/project/data</code><span>.</span></li>
</ol><pre><code class="powershell hljs">sqoop import \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--query</span> <span class="hljs-string">"SELECT empno, sal, e.deptno, dname FROM emps AS e JOIN depts AS d ON (e.deptno=d.deptno) WHERE e.deptno&gt;10 AND \<span class="hljs-variable">$CONDITIONS</span> "</span> \
    <span class="hljs-literal">--target-dir</span> /project/<span class="hljs-keyword">data</span> \
    <span class="hljs-literal">--split-by</span> <span class="hljs-string">"e.deptno"</span>
</code></pre><div class="alert alert-info">
<p><strong><span>Note:</span></strong><span> If you use </span><code>--query</code><span> then you should specify the target directory </span><code>--target-dir</code><span>, the column to split by </span><code>--split-by</code><span>, and add the token </span><code>$CONDITIONS</code><span> to WHERE clause.</span></p>
<p><span>The default behavior of </span><code>--split-by</code><span> is to split the query based on the primary key. You can ask </span><code>Sqoop import</code><span> to use one mapper if no primary key is in the table by using the option </span><code>--autoreset-to-one-mapper</code><span>.</span></p>
</div><ol start="8">
<li><span>Import all tables of the database </span><code>project</code><span> and store them in HDFS at </span><code>/project</code><span> folder.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop <span class="hljs-built_in">import-all</span><span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--warehouse-dir</span> /project
</code></pre><div class="alert alert-info">
<p><strong><span>Note:</span></strong><span> Here you cannot use </span><code>--target-dir</code><span> but you have </span><code>--warehouse-dir</code><span> to specify the folder where the imported tables will be stored. To delete the previous warehouse folder, you need to do it manually via </span><code>hdfs dfs -rm -r</code><span> command as follows:</span></p>
<pre><code class="wrap powershell hljs">hdfs dfs <span class="hljs-literal">-rm</span> <span class="hljs-literal">-r</span> /project
</code></pre>
</div><div class="alert alert-info">
<p><span>In import commands of Sqoop, you can use the option </span><code>--direct</code><span> to speed up the import process where the connector of the database is used instead of map-reduce jobs but it has limitations.</span></p>
</div><ol start="9">
<li><span>Import all tables of the database </span><code>project</code><span> and store them in HDFS at </span><code>/project</code><span> folder as AVRO data files.</span></li>
</ol><div class="alert alert-danger">
<pre><code class="wrap powershell hljs">sqoop <span class="hljs-built_in">import-all</span><span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--warehouse-dir</span> /project \
    <span class="hljs-literal">--as-avrodatafile</span>
</code></pre>
</div><div class="alert alert-warning">
<p><strong><span>Note:</span></strong><span> You may encounter an issue when importing as AVRO data file and will fail the Mapreduce job, as follows:</span></p>
<pre><code class="wrap hljs">Error: org.apache.avro.reflect.ReflectData.addLogicalTypeConversion(Lorg/apache/avro/Conversion;)V
23/03/26 01:03:36 INFO mapreduce.Job: Task Id : attempt_1679726770006_0016_m_000000_1, Status : FAILED
</code></pre>
<p><span>The solution is to add the option </span><code>-Dmapreduce.job.user.classpath.first=true</code><span> after the tool name immediately, as follows.</span></p>
<!-- ![](https://i.imgur.com/vsLvg0d.png) -->
<pre><code class="wrap powershell hljs">sqoop <span class="hljs-built_in">import-all</span><span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">-Dmapreduce</span>.job.user.classpath.first=true \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--warehouse-dir</span> /project \
    <span class="hljs-literal">--as-avrodatafile</span>
</code></pre>
<p><span>Source: </span><a href="https://community.cloudera.com/t5/Support-Questions/Sqoop-import-to-avro-failing-which-jars-to-be-used/m-p/124080#M86824" target="_blank" rel="noopener"><span>https://community.cloudera.com/t5/Support-Questions/Sqoop-import-to-avro-failing-which-jars-to-be-used/m-p/124080#M86824</span></a></p>
<p><span>By default Hadoop framework jars appear before the users’ jars in the classpath, such that the classes from the 2.x.x jar will still be picked.</span></p>
</div><div class="alert alert-info">
<p><strong><span>Note:</span></strong><span> You cannot use the option </span><code>--direct</code><span> for AVRO files since AVRO is not supported here.</span></p>
<p><span>Importing files as AVRO format will generate schema </span><code>.avsc</code><span> for each table in the current directory of the local file system. These schemas need to be placed in HDFS manually via command </span><code>hdfs dfs -put</code><span>. You can specify the path where the </span><code>.avsc</code><span> files are stored via the option </span><code>--outdir</code><span>.</span></p>
</div><ol start="10">
<li><span>Import all tables of the database </span><code>project</code><span> and store them in HDFS at </span><code>/project</code><span> folder as AVRO data files and compressed using Snappy compression method in HDFS.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop <span class="hljs-built_in">import-all</span><span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">-Dmapreduce</span>.job.user.classpath.first=true \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--warehouse-dir</span> /project \
    <span class="hljs-literal">--as-avrodatafile</span> \
    <span class="hljs-literal">--compression-codec</span>=snappy \
    <span class="hljs-literal">--outdir</span> /project/avsc \
    <span class="hljs-literal">--m</span> <span class="hljs-number">1</span>
</code></pre><div class="alert alert-info">
<p><span>You can limit the number of file partitions or mappers via setting the option </span><code>--m</code><span>, for instance </span><code>--m 1</code><span> for one mapper.</span></p>
</div><h2 id="Sqoop-job" data-id="Sqoop-job"><a class="anchor hidden-xs" href="#Sqoop-job" title="Sqoop-job"><span class="octicon octicon-link"></span></a><span>Sqoop job</span></h2><p><span>The </span><code>sqoop job</code><span> tool allows you to create and work with saved jobs stored in Sqoop metastore. Saved jobs remember the parameters used to specify a job, so they can be re-executed by invoking the job by its handle.</span></p><p><span>If a saved job is configured to perform an incremental import, state regarding the most recently imported rows is updated in the saved job to allow the job to continually import only the newest rows.</span></p><ol start="11">
<li><span>Create a job to import all tables of the database </span><code>project</code><span> and store it in HDFS at </span><code>/project</code><span> folder as AVRO data files and compressed using Snappy compression method in HDFS and using only one mapper.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop job \
    <span class="hljs-literal">--create</span> myprojectjob \
    <span class="hljs-literal">--</span> <span class="hljs-built_in">import-all</span><span class="hljs-literal">-tables</span> \
    <span class="hljs-literal">-Dmapreduce</span>.job.user.classpath.first=true \
    <span class="hljs-literal">--connect</span> jdbc:postgresql://localhost/project \
    <span class="hljs-literal">--username</span> postgres \
    <span class="hljs-literal">--warehouse-dir</span> /project \
    <span class="hljs-literal">--as-avrodatafile</span> \
    <span class="hljs-literal">--compression-codec</span>=snappy \
    <span class="hljs-literal">--m</span> <span class="hljs-number">1</span> 
</code></pre><div class="alert alert-warning">
<p><span>If these </span><code>sqoop job</code><span> commands ask for the password of the database user, just skip it by pressing Enter. The Sqoop metastore is not a secure resource. Multiple users can access its contents. For this reason, Sqoop does not store passwords in the metastore. If you create a job that requires a password, you will be prompted for that password each time you execute the job.</span></p>
</div><ol start="12">
<li><span>List all jobs.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop job <span class="hljs-literal">--list</span>
</code></pre><ol start="13">
<li><span>Inspect your saved job.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop job <span class="hljs-literal">--show</span> myprojectjob
</code></pre><ol start="14">
<li><span>Execute the saved job.</span></li>
</ol><pre><code class="wrap powershell hljs">sqoop job <span class="hljs-literal">--exec</span> myprojectjob <span class="hljs-literal">--</span> <span class="hljs-literal">--username</span> postgres
</code></pre><h2 id="self-study-Incremental-import" data-id="self-study-Incremental-import"><a class="anchor hidden-xs" href="#self-study-Incremental-import" title="self-study-Incremental-import"><span class="octicon octicon-link"></span></a><span>[self-study] Incremental import</span></h2><p><span>Sqoop provides an incremental import mode which can be used to retrieve only rows newer than some previously-imported set of rows. Here we have three options:</span></p><pre><code class="wrap powershell hljs"><span class="hljs-literal">--check-column</span> &lt;col&gt; <span class="hljs-comment"># Specifies the column to be examined when determining which rows to import. The column should not be of string type.</span>
<span class="hljs-literal">--incremental</span> &lt;mode&gt; <span class="hljs-comment"># Specifies how Sqoop determines which rows are new. Legal values for mode include "append" and "lastmodified".</span>
<span class="hljs-literal">--last-value</span> &lt;value&gt; <span class="hljs-comment"># Specifies the maximum value of the check column from the previous import.</span>
</code></pre><p><span>You should specify </span><code>append</code><span> mode when importing a table where new rows are continually being added with increasing row id values. You specify the column containing the row’s id with </span><code>--check-column</code><span>. Sqoop imports rows where the check column has a value greater than the one specified with </span><code>--last-value</code><span>.</span></p><p><span>An alternate table update strategy supported by Sqoop is called </span><code>lastmodified</code><span> mode. You should use this when rows of the source table may be updated, and each such update will set the value of a last-modified column to the current timestamp. Rows where the check column holds a timestamp more recent than the timestamp specified with --last-value are imported.</span></p><p><span>At the end of an incremental import, the value which should be specified as </span><code>--last-value</code><span> for a subsequent import is printed to the screen. When running a subsequent import, you should specify </span><code>--last-value</code><span> in this way to ensure you import only the new or updated data. This is handled automatically by creating an incremental import as a saved job, which is the preferred mechanism for performing a recurring incremental import.</span></p><div class="alert alert-warning">
<p><span>Incremental import works only for </span><code>sqoop import</code><span> tool.</span></p>
</div><p><span>You can see an example in this </span><a href="https://medium.com/@nitingupta.bciit/apache-sqoop-incremental-import-with-sqoop-job-949b60e1101a" target="_blank" rel="noopener"><span>tutorial</span></a><span> for incremental import.</span></p><h1 id="References" data-id="References"><a class="anchor hidden-xs" href="#References" title="References"><span class="octicon octicon-link"></span></a><span>References</span></h1><ul>
<li><a href="https://www.cs.uct.ac.za/mit_notes/database/htmls/chp03.html" target="_blank" rel="noopener"><span>toy-dataset</span></a></li>
<li><a href="https://sqoop.apache.org/docs/1.4.6/SqoopUserGuide.html#_introduction" target="_blank" rel="noopener"><span>Sqoop User Guide</span></a></li>
<li><a href="https://www.postgresql.org/docs/current/sql-copy.html" target="_blank" rel="noopener"><span>PostgreSQL documentation</span></a></li>
<li><a href="https://towardsdatascience.com/apache-sqoop-1113ce453639" target="_blank" rel="noopener"><span>Tutorial on Apache Sqoop</span></a></li>
</ul></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#Stage-I---Data-collection-and-Ingestion" title="Stage I - Data collection and Ingestion">Stage I - Data collection and Ingestion</a></li>
<li><a href="#Dataset" title="Dataset">Dataset</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Description" title="Description">Description</a></li>
<li><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li><a href="#Build-a-relational-Database-via-PostgreSQL" title="Build a relational Database via PostgreSQL">Build a relational Database via PostgreSQL</a></li>
<li><a href="#AVRO-amp-Snappy" title="AVRO &amp; Snappy">AVRO &amp; Snappy</a></li>
<li><a href="#Import-the-database-into-HDFS-via-Sqoop" title="Import the database into HDFS via Sqoop">Import the database into HDFS via Sqoop</a><ul class="nav">
<li><a href="#Sqoop-eval" title="Sqoop eval">Sqoop eval</a></li>
<li><a href="#Sqoop-import" title="Sqoop import">Sqoop import</a></li>
<li><a href="#Sqoop-job" title="Sqoop job">Sqoop job</a></li>
<li><a href="#self-study-Incremental-import" title="[self-study] Incremental import">[self-study] Incremental import</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li><a href="#Stage-I---Data-collection-and-Ingestion" title="Stage I - Data collection and Ingestion">Stage I - Data collection and Ingestion</a></li>
<li><a href="#Dataset" title="Dataset">Dataset</a></li>
<li><a href="#Agenda" title="Agenda">Agenda</a></li>
<li><a href="#Prerequisites" title="Prerequisites">Prerequisites</a></li>
<li><a href="#Objectives" title="Objectives">Objectives</a></li>
<li><a href="#Description" title="Description">Description</a></li>
<li><a href="#Dataset-Description" title="Dataset Description">Dataset Description</a></li>
<li><a href="#Build-a-relational-Database-via-PostgreSQL" title="Build a relational Database via PostgreSQL">Build a relational Database via PostgreSQL</a></li>
<li><a href="#AVRO-amp-Snappy" title="AVRO &amp; Snappy">AVRO &amp; Snappy</a></li>
<li><a href="#Import-the-database-into-HDFS-via-Sqoop" title="Import the database into HDFS via Sqoop">Import the database into HDFS via Sqoop</a><ul class="nav">
<li><a href="#Sqoop-eval" title="Sqoop eval">Sqoop eval</a></li>
<li><a href="#Sqoop-import" title="Sqoop import">Sqoop import</a></li>
<li><a href="#Sqoop-job" title="Sqoop job">Sqoop job</a></li>
<li><a href="#self-study-Incremental-import" title="[self-study] Incremental import">[self-study] Incremental import</a></li>
</ul>
</li>
<li><a href="#References" title="References">References</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
